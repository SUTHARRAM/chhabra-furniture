openapi: 3.0.0
info:
  title: productDetailsCounts API
  version: 1.0.0
  description: |
    This service is used to calculate CQS score, secondary image count, and count of products with less ISQ for a GlUserId.

    **NOTE**
    - All the request parameters are **case-sensitive**.
    - If any input parameter is not mandatory, it should **not be passed** at all if no value is provided or no change is required.
    - This API works on **GET** methods.
    - The service supports only **HTTPS** requests.
    - This is a Read Api

servers:
  - url: https://dev-merp.intermesh.net/
  - url: https://stg-merp.intermesh.net/
  - url: https://merp.intermesh.net/

paths:
  /api/production/v1/productDetailsCounts:
    get:
      tags:
        - API Details and Responses
      summary: Calculate CQS and count of different product images
      description: |
        This API collects data from the product table to calculate the CQS score and other details such as secondary image count and less ISQ count for a GlUserId.

        **NOTE**
        - All the request parameters are **case-sensitive**.
        - If a parameter is optional, do not pass it at all if no value is available.
        - Only the **GET** method is supported.
        - This service supports only **HTTPS** requests.
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: empid
          required: true
          description: Employee id
          schema:
            type: integer
            format: int64
            example: 106494
        - in: query
          name: glid
          required: true
          description: GlUserId
          schema:
            type: integer
            format: int64
            example: 130099680
        - in: query
          name: modid
          required: true
          description: Module ID
          schema:
            type: string
            example: prod
      responses:
        '200':
          description: Success Response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SampleResponse'
              examples:
                Success:
                  value:
                    status: 200
                    data:
                      CQS: 5
                      PRODUCT_COUNT_WITH_LESS_ISQS: 4
                      PRODUCT_COUNT_WITH_SECONDARY_IMAGES: 0
                      UNIQUE_MCAT_COUNT: 0
                    message: "successful"
        '400':
          description: Missing Mandatory params or Invalid Params
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SampleResponse'
              examples:
                MissingMandatoryOrInvalid:
                  value:
                    status: 400
                    data:
                      CQS: 0
                      PRODUCT_COUNT_WITH_LESS_ISQS: 0
                      PRODUCT_COUNT_WITH_SECONDARY_IMAGES: 0
                      UNIQUE_MCAT_COUNT: 0
                    message: "Missing Mandatory params or Invalid Params!"
                GlidMissing:
                  value:
                    status: 400
                    data: {}
                    message: "Glid is not present"
        '401':
          description: AK is missing / Expired / AK of other Emp
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SampleResponse'
              examples:
                WrongAK:
                  value:
                    status: 401
                    data:
                      CQS: 0
                      PRODUCT_COUNT_WITH_LESS_ISQS: 0
                      PRODUCT_COUNT_WITH_SECONDARY_IMAGES: 0
                      UNIQUE_MCAT_COUNT: 0
                    message: "Invalid AK!"
                AKNotPassedInHeader:
                  value:
                    status: 401
                    data: null
                    message: "Authorization header missing"
                    error: "Authorization header missing"
                AuthenticationFailure:
                  value:
                    status: 401
                    data: {}
                    message: "Authentication Failure"
        '422':
          description: No product data found for the given GlUserId
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SampleResponse'
              examples:
                NoData:
                  value:
                    status: 422
                    data:
                      CQS: 0
                      PRODUCT_COUNT_WITH_LESS_ISQS: 0
                      PRODUCT_COUNT_WITH_SECONDARY_IMAGES: 0
                      UNIQUE_MCAT_COUNT: 0
                    message: "No product data found"
        '500':
          description: Failure / Internal Server Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SampleResponse'
              examples:
                FailureCase:
                  value:
                    status: 500
                    data: {}
                    message: "Failure"
                DatabaseError:
                  value:
                    status: 500
                    data: {}
                    message: "Error in Fetching Data from DB"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    SampleResponse:
      type: object
      properties:
        status:
          type: integer
        data:
          type: object
        message:
          type: string